set(OUT_PACK_PATH @CMAKE_BINARY_DIR@/@ADDON_NAME@.zip)
set(ADDON_WORK_ROOT @CMAKE_BINARY_DIR@/pack)
set(ADDON_ROOT ${ADDON_WORK_ROOT}/@ADDON_NAME@)
set(BINARY_DIR ${ADDON_ROOT}/resources/bin)

# clean pack dir
file(REMOVE_RECURSE ${ADDON_ROOT} ${OUT_PACK_PATH})
file(MAKE_DIRECTORY ${ADDON_ROOT})
file(MAKE_DIRECTORY ${BINARY_DIR})

# copy files
file(COPY @CMAKE_SOURCE_DIR@/kodi-addon/ DESTINATION ${ADDON_ROOT})
file(COPY @BINARY_PATH@ DESTINATION ${BINARY_DIR} USE_SOURCE_PERMISSIONS)

# create archive
if(@ARCHIVER_TYPE@ STREQUAL zip)
    execute_process(COMMAND
        @ZIP_BIN@ -r ${OUT_PACK_PATH} @ADDON_NAME@
        WORKING_DIRECTORY ${ADDON_WORK_ROOT})
endif()
